<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0042)http://arcbotics.com/lessons/maze-solving/ -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
 
<script type="text/javascript" async="" data-rocketsrc="http://www.google-analytics.com/ga.js" data-rocketoptimized="true"></script><script id="twitter-wjs" data-rocketsrc="//platform.twitter.com/widgets.js" data-rocketoptimized="true"></script><script type="text/javascript" async="" data-rocketsrc="http://www.google-analytics.com/ga.js" data-rocketoptimized="true"></script><script async="" charset="utf-8" data-rocketsrc="//v2.zopim.com/?2iggZSQJWPrpOoguvrKqHxOWOPpV2NhZ" data-rocketoptimized="true" type="text/javascript"></script><script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok3v=1613a3a185/"},atok:"e7b276a8d308d54599dc949ec6b0a3e7",petok:"99adc3ffdb04b1fd708a1f598641cd2938bec71f-1425404648-1800",zone:"arcbotics.com",rocket:"a",apps:{}}];document.write('<script type="text/javascript" src="//ajax.cloudflare.com/cdn-cgi/nexp/dok3v=919620257c/cloudflare.min.js"><'+'\/script>');}}catch(e){};
//]]>
</script><script type="text/javascript" src="./Maze Solving_files/cloudflare.min.js"></script><style type="text/css">.cf-hidden { display: none; } .cf-invisible { visibility: hidden; }</style><script data-module="cloudflare/rocket" id="cfjs_block_ed22bc697e" onload="CloudFlare.__cfjs_block_ed22bc697e_load()" onerror="CloudFlare.__cfjs_block_ed22bc697e_error()" onreadystatechange="CloudFlare.__cfjs_block_ed22bc697e_readystatechange()" type="text/javascript" src="./Maze Solving_files/rocket.js"></script>
<script type="text/rocketscript" data-rocketoptimized="true">
window.$zopim||(function(d,s){var z=$zopim=function(c){z._.push(c)},$=z.s=
d.createElement(s),e=d.getElementsByTagName(s)[0];z.set=function(o){z.set.
_.push(o)};z._=[];z.set._=[];$.async=!0;$.setAttribute('charset','utf-8');
$.src='//v2.zopim.com/?2iggZSQJWPrpOoguvrKqHxOWOPpV2NhZ';z.t=+new Date;$.
type='text/javascript';e.parentNode.insertBefore($,e)})(document,'script');
</script>
 
<title> Maze Solving</title>
<script type="text/rocketscript" data-rocketoptimized="true">//<![CDATA[
            // Google Analytics for WordPress by Yoast v4.3.5 | http://yoast.com/wordpress/google-analytics/
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-26466311-1']);
				            _gaq.push(['_setAllowLinker',true],['_setDomainName','arcbotics.com'],['_trackPageview']);
            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            //]]></script>
<link rel="alternate" type="application/rss+xml" title="ArcBotics » Maze Solving Comments Feed" href="http://arcbotics.com/lessons/maze-solving/feed/">
<link rel="stylesheet" id="crayon-css" href="./Maze Solving_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-arduino-ide-css" href="./Maze Solving_files/arduino-ide.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./Maze Solving_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="aj-collapse-style-css" href="./Maze Solving_files/aj-collapse.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-ui-css" href="./Maze Solving_files/wp-ui.css" type="text/css" media="all">
<link rel="stylesheet" id="wpui-light-css" href="./Maze Solving_files/wpui-light.css" type="text/css" media="all">
<link rel="stylesheet" id="wpui-multiple-css" href="./Maze Solving_files/css.php" type="text/css" media="all">
<script type="text/rocketscript" data-rocketsrc="https://ajax.googleapis.com/ajax/libs/jquery/1.10.3/jquery.min.js?ver=3.8.5" data-rocketoptimized="true"></script><script type="text/javascript" src="./Maze Solving_files/jquery.min.js"></script>
<script type="text/rocketscript" data-rocketoptimized="true">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.6.1","is_admin":"0","ajaxurl":"http:\/\/arcbotics.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/rocketscript" data-rocketsrc="http://static.arcbotics.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=2.6.1" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://arcbotics.com/?wpui-script=begin&amp;ver=0.8.8" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js?ver=0.8.8" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js?ver=3.8.5" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://arcbotics.com/?wpui-script=before&amp;ver=3.8.5" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketoptimized="true">
/* <![CDATA[ */
var wpUIOpts = {"wpUrl":"http:\/\/arcbotics.com","pluginUrl":"http:\/\/arcbotics.com\/wp-content\/plugins\/wp-ui\/","enableTabs":"on","enableAccordion":"on","enableSpoilers":"on","enableDialogs":"on","tabsEffect":"none","effectSpeed":"400","accordEffect":"none","alwaysRotate":"stop","tabsEvent":"click","collapsibleTabs":"off","accordEvent":"click","singleLineTabs":"off","accordAutoHeight":"on","accordCollapsible":"off","accordEasing":"false","mouseWheelTabs":"false","bottomNav":"on","tabPrevText":"Prev","tabNextText":"Next","spoilerShowText":"Click to show","spoilerHideText":"Click to hide","cookies":"on","hashChange":"on","docWriteFix":"on","linking_history":"on","misc_options":"hashing_timeout=1000"};
/* ]]> */
</script>
<script type="text/rocketscript" data-rocketsrc="http://static.arcbotics.com/wp-content/plugins/wp-ui/js/wp-ui.js?ver=0.8.8" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://arcbotics.com/?wpui-script=end&amp;ver=0.8.8" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://static.arcbotics.com/wp-content/plugins/adjustly-collapse/aj-collapse.js?ver=3.8.5" data-rocketoptimized="true"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://arcbotics.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://static.arcbotics.com/wp-includes/wlwmanifest.xml">
<link rel="prev" title="Drawing with Sparki" href="http://arcbotics.com/lessons/drawing-with-sparki/">
<link rel="next" title="Making Music with the Accelerometer" href="http://arcbotics.com/lessons/making-music-with-the-accelerometer/">
<meta name="generator" content="WordPress 3.8.5">
<link rel="canonical" href="./Maze Solving_files/Maze Solving.htm">
<link rel="shortlink" href="http://arcbotics.com/?p=2492">
<script data-rocketsrc="//load.sumome.com/" data-sumo-site-id="330d084db31785d3f169342ebe62e3c24d10a4e6e13cdca3de4c5072f8458cc4" async="" type="text/rocketscript" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");twitterWidgets.onload = _ga.trackTwitter;</script>
<style type="text/css">.broken_link,a.broken_link{text-decoration:line-through;}</style>
<meta name="rttheme_effect_options" content="turnLeft">
<meta name="rttheme_slider_time_out" content="4000">
<meta name="rttheme_slider_numbers" content="true">
<link rel="pingback" href="http://arcbotics.com/xmlrpc.php">
<link rel="shortcut icon" href="http://static.arcbotics.com/wp-content/themes/rttheme7/images/favicon.ico">
<link rel="stylesheet" type="text/css" href="./Maze Solving_files/style.css">
<link rel="stylesheet" type="text/css" href="./Maze Solving_files/style_cf.css">
<link rel="stylesheet" type="text/css" href="./Maze Solving_files/prettyPhoto.css" media="screen">
<script type="text/rocketscript" data-rocketoptimized="true">//<![CDATA[
            // Google Analytics for WordPress by Yoast v4.3.5 | http://yoast.com/wordpress/google-analytics/
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-26466311-1']);
				            _gaq.push(['_setAllowLinker',true],['_setDomainName','arcbotics.com'],['_trackPageview']);
            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            //]]></script>
<link rel="alternate" type="application/rss+xml" title="ArcBotics » Maze Solving Comments Feed" href="http://arcbotics.com/lessons/maze-solving/feed/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://arcbotics.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://static.arcbotics.com/wp-includes/wlwmanifest.xml">
<link rel="prev" title="Drawing with Sparki" href="http://arcbotics.com/lessons/drawing-with-sparki/">
<link rel="next" title="Making Music with the Accelerometer" href="http://arcbotics.com/lessons/making-music-with-the-accelerometer/">
<meta name="generator" content="WordPress 3.8.5">
<link rel="canonical" href="./Maze Solving_files/Maze Solving.htm">
<link rel="shortlink" href="http://arcbotics.com/?p=2492">
<script data-rocketsrc="//load.sumome.com/" data-sumo-site-id="330d084db31785d3f169342ebe62e3c24d10a4e6e13cdca3de4c5072f8458cc4" async="" type="text/rocketscript" data-rocketoptimized="true"></script><script type="text/rocketscript" data-rocketoptimized="true">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");twitterWidgets.onload = _ga.trackTwitter;</script>
<style type="text/css">.broken_link,a.broken_link{text-decoration:line-through;}</style>
<script type="text/rocketscript" data-rocketsrc="http://static.arcbotics.com/wp-content/themes/rttheme7/js/ddsmoothmenu.js" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://static.arcbotics.com/wp-content/themes/rttheme7/js/script.js" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://static.arcbotics.com/wp-content/themes/rttheme7/js/jquery.prettyPhoto.js" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://static.arcbotics.com/wp-content/themes/rttheme7/js/cufon.js" data-rocketoptimized="true"></script>
<script type="text/rocketscript" data-rocketsrc="http://static.arcbotics.com/wp-content/themes/rttheme7/js/Lucida_400.font.js" data-rocketoptimized="true"></script>
<!--[if IE 6]>
<script type='text/javascript' src='http://static.arcbotics.com/wp-content/themes/rttheme7/js/dd_belated_png.js'></script>
<script>DD_belatedPNG.fix('.png,#wrapper_top, #wrapper_middle_01, #wrapper_bottom,  blockquote');</script>
<![endif]-->
<style type="text/css">cufon{text-indent:0!important;}@media screen,projection{cufon{display:inline!important;display:inline-block!important;position:relative!important;vertical-align:middle!important;font-size:1px!important;line-height:1px!important;}cufon cufontext{display:inline-block!important;width:0!important;height:0!important;overflow:hidden!important;text-indent:-10000in!important;}cufon canvas{position:relative!important;}}@media print{cufon{padding:0!important;}cufon canvas{display:none!important;}}</style><style media="print" class="jx_ui_StyleSheet" __jx__id="___$_2" type="text/css">.zopim { display: none !important }</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="8dc42610-ae42-4164-90b1-573478b46574/service" data-rocketsrc="//d2hpw6pw4uian4.cloudfront.net/static/cd9b6d0f6c87b2a6f2efeceecc134b87d6ccd66e/client/js/8dc42610-ae42-4164-90b1-573478b46574/service.js" data-rocketoptimized="true"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="822aaf16-c4d6-4241-911a-41567c68b443/service" data-rocketsrc="//d2hpw6pw4uian4.cloudfront.net/static/cd9b6d0f6c87b2a6f2efeceecc134b87d6ccd66e/client/js/822aaf16-c4d6-4241-911a-41567c68b443/service.js" data-rocketoptimized="true"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="a25489e9-848c-4356-97ff-161b0852c509/service" data-rocketsrc="//d2hpw6pw4uian4.cloudfront.net/static/cd9b6d0f6c87b2a6f2efeceecc134b87d6ccd66e/client/js/a25489e9-848c-4356-97ff-161b0852c509/service.js" data-rocketoptimized="true"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="2c40add5-3570-45d7-8212-8fc2942f7f74/service" data-rocketsrc="//d2hpw6pw4uian4.cloudfront.net/static/cd9b6d0f6c87b2a6f2efeceecc134b87d6ccd66e/client/js/2c40add5-3570-45d7-8212-8fc2942f7f74/service.js" data-rocketoptimized="true"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="408190b5-e369-48af-8e31-afb7380ecd66/service" data-rocketsrc="//d2hpw6pw4uian4.cloudfront.net/static/cd9b6d0f6c87b2a6f2efeceecc134b87d6ccd66e/client/js/408190b5-e369-48af-8e31-afb7380ecd66/service.js" data-rocketoptimized="true"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="13359558-e447-43f3-a3cd-aa61c0b91c02/service" data-rocketsrc="//d2hpw6pw4uian4.cloudfront.net/static/cd9b6d0f6c87b2a6f2efeceecc134b87d6ccd66e/client/js/13359558-e447-43f3-a3cd-aa61c0b91c02/service.js" data-rocketoptimized="true"></script><link type="text/css" rel="stylesheet" href="./Maze Solving_files/sme-popup.css"><link type="text/css" rel="stylesheet" href="./Maze Solving_files/sme-contactform-popup.css"><link type="text/css" rel="stylesheet" href="./Maze Solving_files/sumome-smartbar-popup.css"><link type="text/css" rel="stylesheet" href="./Maze Solving_files/sumome-scrollbox-popup.css"></head>
<body data-twttr-rendered="true" style="padding-top: 53px !important;"><div id="sumome-smartbar-popup" class="sumome-smartbar-popup sumome-smartbar-shadow" style="z-index: 9999999; position: fixed; background-color: rgb(255, 255, 255) !important;"><a class="sumome-smartbar-link" href="http://sumome.com/?src=sm-ba-330d084db31785d3f169342ebe62e3c24d10a4e6e13cdca3de4c5072f8458cc4" target="_blank" style="top: 3.5px;"><img class="sumome-icon" src="./Maze Solving_files/transparent-crown-light.png"></a><a href="javascript:void(0);" class="sumome-smartbar-close" style="color: rgb(34, 34, 34) !important; top: 5.5px;"></a><div class="sumome-smartbar-content"><div class="sumome-smartbar-theme sumome-smartbar-modal-bg" style="background-color: rgb(255, 255, 255) !important; background-position: initial initial !important; background-repeat: initial initial !important;"></div>
<div class="sumome-smartbar-form" style="padding: 7px 0;">
  <div class="sumome-smartbar-text" style="color: rgb(34, 34, 34) !important;">Win a free robot! <a href="http://arcbotics.com/free-robot-contest-rules/"><font size="1">terms</font></a></div>
  <div class="sumome-smartbar-error" style="color: rgb(34, 34, 34) !important; display: none;"></div>
  <div class="sumome-smartbar-input">
    <input type="text" value="" autofocus="" name="smartbar_email_address" id="smartbar_email_address" placeholder="Enter your email address" style="width: 186px;">
    <button class="sumome-smartbar-button sumome-smartbar-button-bg sumome-smartbar-button-text" type="submit" style="background-color: rgb(15, 82, 186) !important; color: rgb(255, 255, 255) !important; border-bottom-color: rgb(0, 57, 161) !important;">Enter</button>
  </div>
  <button class="sumome-smartbar-continue sumome-smartbar-continue-bg sumome-smartbar-continue-text" type="submit" style="display: none; background-color: rgb(15, 82, 186) !important; color: rgb(255, 255, 255) !important; border-bottom-color: rgb(0, 57, 161) !important;">Continue</button>
</div>
</div></div><div class="zopim" __jx__id="___$_59 ___$_59" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; padding: 0px; border: 0px; background-color: transparent; overflow: hidden; position: fixed; z-index: 16000002; width: 180px; height: 30px; right: 10px; bottom: 0px; background-position: initial initial; background-repeat: initial initial;"><iframe seamless="" frameborder="0" style="background-color: transparent; vertical-align: text-bottom; position: relative; width: 100%; height: 100%; margin: 0px; overflow: hidden;" src="javascript:void(document.write('<!DOCTYPE html><html><head><style>html,body{height:100%;width:100%;} *{border:0;padding:0;margin:0;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}</style></head><body onload="window.isLoaded = true"></body></html>'), document.close())"></iframe></div><div class="zopim" __jx__id="___$_4 ___$_4" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; padding: 0px; border: 0px; background-color: transparent; overflow: hidden; position: fixed; z-index: 16000001; right: 10px; bottom: 0px; border-top-left-radius: 5px; border-top-right-radius: 5px; display: none; width: 290px; height: 400px; -webkit-box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 3px 2px; box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 3px 2px; background-position: initial initial; background-repeat: initial initial;"><iframe seamless="" frameborder="0" style="background-color: transparent; vertical-align: text-bottom; position: relative; width: 100%; height: 100%; margin: 0px; overflow: hidden;" src="javascript:void(document.write('<!DOCTYPE html><html><head><style>html,body{height:100%;width:100%;} *{border:0;padding:0;margin:0;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}</style></head><body onload="window.isLoaded = true"></body></html>'), document.close())"></iframe></div>
 
<div id="wrapper" class="sub">
<div id="wrapper_top"></div>
<div id="wrapper_middle_01">
<div id="wrapper_middle">
<div id="wrapper_content">
 
<div id="header">
 
<div id="logo">
<a href="http://arcbotics.com/" title="ArcBotics"><img src="./Maze Solving_files/wb-300x99.png" alt="ArcBotics" class="png"></a>
</div>
 
 
<div id="header_right">
<div id="social_media" style="text-align:right">
<a href="https://www.facebook.com/ArcBotics"><img style="text-align:right" src="./Maze Solving_files/facebook.png" alt="facebook"></a>
<a href="https://twitter.com/arcbotics"><img style="text-align:right" src="./Maze Solving_files/twitter.png" alt="twitter"></a>
<a href="http://arcbotics.com/feed/"><img style="text-align:right" src="./Maze Solving_files/rss.png" alt="arcbotics blog rss"></a>
</div>
 
<div id="navigation">
<div id="dropdown_menu" class="dropdown"><ul id="menu-rt-theme-main-navigation-menu" class=""><li id="menu-item-441" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-441"><a href="http://arcbotics.com/about/">About</a></li><li class="slash">/</li>
<li id="menu-item-2027" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2027"><a href="http://arcbotics.com/get-started/">Get Started</a>
<ul class="sub-menu">
<li id="menu-item-2044" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2044"><a href="http://arcbotics.com/products/sparki/start/">Sparki</a></li>
<li id="menu-item-2045" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2045"><a href="http://arcbotics.com/products/hexy/start/">Hexy</a></li>
</ul>
</li><li class="slash">/</li>
<li id="menu-item-435" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-435"><a href="http://arcbotics.com/products/">Products</a>
<ul class="sub-menu">
<li id="menu-item-438" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-438"><a href="http://arcbotics.com/products/hexy/">Hexy – Open Source Low Cost Fully Articulating DIY Robot Kit</a>
<ul class="sub-menu">
<li id="menu-item-439" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-439"><a href="http://arcbotics.com/products/hexy/start/">Getting Started with Hexy</a></li>
<li id="menu-item-436" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-436"><a href="http://arcbotics.com/products/servotor32/">Servotor32 – USB 32 Servo Controller</a></li>
<li id="menu-item-437" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-437"><a href="http://arcbotics.com/products/pomoco/">PoMoCo – Position and Motion Controller Software</a></li>
</ul>
</li>
<li id="menu-item-502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-502"><a href="http://arcbotics.com/products/sparki/">Sparki – The Easy Robot for Everyone</a>
<ul class="sub-menu">
<li id="menu-item-527" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-527"><a href="http://arcbotics.com/products/sparki/start/">Getting Started with Sparki</a></li>
</ul>
</li>
</ul>
</li><li class="slash">/</li>
<li id="menu-item-955" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-955"><a href="https://arcbotics.mybigcommerce.com/" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-menu&#39;,&#39;http://arcbotics.mybigcommerce.com&#39;]);">Store</a></li><li class="slash">/</li>
<li id="menu-item-489" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-489"><a title="Contact" href="https://arcbotics.zendesk.com/anonymous_requests/new" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-menu&#39;,&#39;http://arcbotics.zendesk.com&#39;]);">Contact</a></li><li class="slash">/</li>
<li id="menu-item-443" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-443"><a href="http://forum.arcbotics.com/">Forums</a></li><li class="slash">/</li>
<li id="menu-item-440" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-440"><a href="http://arcbotics.com/blog/">Blog</a></li></ul></div>
</div>
 
</div>
 
</div>
 
 
<div id="main">
<div class="slicer"></div>
 
<div id="sub_page_header">
 
<div id="sub_nav">
 
You are here: <a href="http://arcbotics.com/" title="ArcBotics">Home</a> \ <a href="http://arcbotics.com/lessons/" title="Sparki Lessons">Sparki Lessons</a> \ Maze Solving  
</div>
 
</div>
 
<div class="slicer_2"></div>
 
<div id="content">
 
<div id="page_left">
<h1>Maze Solving</h1>
<h2>Introduction</h2>
<p>Solving a maze is fun.&nbsp;And&nbsp;at this point, with the things that we have already learned in the previous lessons, we can take advantage of some of Sparki’s sensors to implement some <a href="http://en.wikipedia.org/wiki/Maze_solving_algorithm" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">maze solving programs</a>. To understand this lesson, it’s strongly recommended that you have learned the concepts from the<a href="http://arcbotics.com/lessons/line-following/"> Line Following</a> and the <a href="http://arcbotics.com/lessons/moving-the-robot/">Moving the Robot</a> lessons first.</p>
<p>So, let’s see Sparki go through a maze!</p>
<h2>What You’ll Need</h2>
<ul>
<li>A&nbsp;<a href="http://arcbotics.com/products/sparki/">Sparki</a>.</li>
<li>A maze. What we will use here is the&nbsp;poster in ArcBotics’&nbsp;<a href="http://www.arcbotics.mybigcommerce.com/sparki-materials-pack/" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://www.arcbotics.mybigcommerce.com&#39;]);">Sparki Materials Packs</a>. You can also make your own with a white cardboard as the base, using black insulating plastic tape to “print” the tracks. Or you can download a ready to print maze from <a href="https://github.com/ArcBotics/Sparki/blob/master/Lessons/SparkiDuino/mazeSolving/Sparki.Poster.Maze1.90x70.png" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://github.com&#39;]);" target="_blank">this link</a> (please note that this maze can be printed in standard plotters, since it’s 90 cm wide). Also, you can download that maze’s <a href="https://github.com/ArcBotics/Sparki/blob/master/Lessons/SparkiDuino/mazeSolving/Sparki.Poster.Maze1.90x70.svg" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://github.com&#39;]);" target="_blank">source SVG file</a>, and modify it using the <a href="http://www.inkscape.org/" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://www.inkscape.org&#39;]);" target="_blank">Inskcape</a> open source vector graphics editor (or any other SVG editor of your choice).</li>
</ul>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/Sparki.Poster.Maze1_.Thumb_.png" width="480"></p>
<p>&nbsp;</p>
<h2>How It Works</h2>
<p>One of the simplest ways of solving a maze with a robot is by using the <a href="http://en.wikipedia.org/wiki/Maze_solving_algorithm#Wall_follower" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">Wall Follower algorithm</a>, also know as the <strong>left-hand rule</strong> (or <strong>right-hand rule</strong>). Forget the robot for a while, and suppose that you are a person inside a maze. Then, finding the exit could be done just by keeping one of your hands <strong>always</strong> touching a wall. &nbsp;And by “always”, we really mean <strong>always</strong> here.&nbsp;Take a look to the following animation, where the red point represents the person:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/animatedMazeRedDot.gif"></p>
<p>Do you see the trick? So, what do we have in our Sparki to imitate this behavior on a printed maze? The <a href="http://arcbotics.com/products/sparki/parts/infrared-reflectance-sensor/">line following infrared sensors</a>!&nbsp;So, how do we implement the “Left Hand” algorithm with our Sparki ? The first thing to do is to ensure that Sparki really understands the lines that he is “viewing” with its sensors. And to do that, we will need to use all of our&nbsp;<a href="http://arcbotics.com/products/sparki/parts/infrared-reflectance-sensor/">line and edge sensors</a>.</p>
<p>Let’s remember what sensors we have:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/lineSensors.png"></p>
<p>We will soon see how to use these infrared sensors in our maze solving problem. First, let’s talk a bit about geometry…</p>
<p>&nbsp;</p>
<h2>Maze Geometry and Sparki</h2>
<p>We can freely draw a maze and try to program Sparki to escape from it. But sooner than later we will find that not every robot can solve every maze. There are some shape and size constraints that we should think of when leaving a poor robot alone in a maze. Some are easier to spot, like the size of the robot to the maze. Suppose that your robot is too big (or too small) for the maze:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/robotTooBig.png"></p>
<p>But other constraints are not that obvious, and we may need to figure them out when we are trying hard to program the maze solver algorithm on a specific robot. Things like the number of sensors, the distances between them, and the distances from the sensors to the wheels centers, may become really important in this kind of activity.</p>
<p>Let’s enumerate here the most important rules to follow when we are creating our printed maze for this Sparki activity:</p>
<p><strong>1. Line width:</strong>&nbsp;We are going to use the black line as the maze itself here. Although there are other methods to solve this kind of maze, we will try to simplify the programming as much as possible. So, to make things easier for Sparki, let’s impose the condition that the line width has to be a bit bigger than the distance between the <strong>Line Left Sensor</strong> and the <strong>Right Left Sensor</strong> (please see the picture above as a reference for the sensors names). As we will see soon, this will make it easier for Sparki to follow this kind of line. So our line’s width here will be <strong>3.5 cm</strong> (<a href="http://en.wikipedia.org/wiki/Centimetre" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">centimeters</a>). A line much bigger (even something like 4 cm) would not be that good for Sparki, so this is not just a minimum width, but a <em>desired</em> width:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/lineWidth.png"></p>
<p><strong>2. Distance from the lines to the borders:</strong> Sparki should be able to turn when the line forms a corner in a way that both its <strong>Edge Right Sensor</strong> and its <strong>Edge Left Sensors</strong>&nbsp;are kept over the white background. This will avoid false readings due to an out of the maze floor sensor. To ensure this, the maze line has to be always at a <strong>minimum</strong> distance from the base edges of about <strong>6 cm:</strong></p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/borderDistance.png" width="450"></p>
<p><strong>3. Distance between branches:</strong>&nbsp;Similar to the previous rule, Sparki has to be able to turn without accidentally running into a maze wall with its edge sensors. Because of this, the branches should be at a distance big enough from other lines and branches. A good minimum distance is about&nbsp;<strong>10 cm</strong> (both&nbsp;horizontally and vertically):</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/branchesDistance.png"></p>
<p>&nbsp;</p>
<p><strong>4. 90 degrees corners and branches:</strong>&nbsp;As you have seen in all the previous maze pictures, all the corners and branches are 90 <a href="http://en.wikipedia.org/wiki/Degree_(angle)" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">degrees</a>. This will be necessary to help Sparki find dead ends and branches.</p>
<p><strong>5. End mark:</strong>&nbsp;It’s always desirable to have a way to determine that the maze end has been reached. So it’s good to add an <strong>end mark</strong>. An end mark is a shape that is unique to the end of the maze, from the robot’s point of view. In our maze, we created a mark that keeps the <strong>Line Center Sensor</strong> reading white, while both the <strong>Edge Right Sensor</strong> and the <strong>Edge Left Sensor</strong> read black. If you look carefully at the maze, this combination of sensors readings is not possible in any other place of our maze course:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/endMark.png"></p>
<p>Now we have a good idea of which kind of maze is Sparki going to solve, and with what sensors it’s going to do it. Also, we know that we are going to use the&nbsp;<a href="http://en.wikipedia.org/wiki/Maze_solving_algorithm#Wall_follower" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">Wall Follower algorithm</a>&nbsp;(or <strong>left-hand rule</strong>). So let’s see how to code this!</p>
<p><img alt="Warning_Triangle" src="./Maze Solving_files/Warning_Triangle.png" width="32" height="28">&nbsp;Please remember to check that the batteries are properly connected (and charged!). And as we are going to use the motors here, please check that the&nbsp;<a href="http://arcbotics.com/products/sparki/parts/onoff-switch/">On/Off Switch</a>&nbsp;is on.&nbsp;Another important thing to take care of when playing with the robot’s motors is to be careful not to be working over a table.&nbsp;A fall from that table could permanently damage your Sparki.</p>
<p>&nbsp;</p>
<h2>The Main Idea</h2>
<p>At a high level, the <strong>Wall Follower algorithm</strong> really consists of these simple steps:</p>
<ol>
<li>If you can <strong>turn left</strong>, do it.</li>
<li>Else (if you can’t turn left), if you can continue going straight, just <strong>go straight</strong>.</li>
<li>Else (if you can’t do neither of the previous steps), if you can&nbsp;<strong>turn right</strong>, do it.</li>
<li>If you reached a dead end, <strong>turn back</strong>.</li>
</ol>
<p>&nbsp;</p>
<p>But as we will soon see, it is not always that simple for a real robot. For example, even just going straight may be a problem for the robot if it’s positioned with an angular error with respect to the black line. Also, detecting branches may imply using more than one sensor, as we are going to see soon. Please keep reading!</p>
<p>&nbsp;</p>
<h2>Splitting the Problem</h2>
<h3>Going Straight</h3>
<p><span style="line-height: 1.5em;">So, our first problem is how to make Sparki go straight through the maze. Fortunately, we already know how to program Sparki to </span><a style="line-height: 1.5em;" href="http://arcbotics.com/lessons/line-following/">follow a line</a><span style="line-height: 1.5em;">. So we will use that knowledge here, but adapt it to our specific problem. </span></p>
<p><span style="line-height: 1.5em;">In the </span><a style="line-height: 1.5em;" href="http://arcbotics.com/lessons/line-following/">Line Following lesson</a><span style="line-height: 1.5em;">, the robot followed a line that was narrower than the distance between the </span><strong style="line-height: 1.5em;">Line Left Sensor</strong><span style="line-height: 1.5em;"> and the </span><strong style="line-height: 1.5em;">Line Right Sensor</strong><span style="line-height: 1.5em;">. This time, the line is a bit wider. And we are using that kind of line deliberately here, because it’s really easy to keep the robot centered while the </span><strong style="line-height: 1.5em;">edge sensors</strong><span style="line-height: 1.5em;"> take care of the branches and dead ends. </span></p>
<p><span style="line-height: 1.5em;">In the following picture, the green color for a sensor state means that that sensor just doesn’t care in our evaluation of the sensors readings:</span></p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/lineFollowingStates.png" width="350"></p>
<p><span style="line-height: 1.5em;">Here is the code for the line following method that we will be using:</span></p> 
<div id="crayon-54e6e132f212f453113443" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">#include &lt;Sparki.h&gt; // include the sparki library

const int threshold = 500; //line sensors thereshold.
const int turnSpeed = 40; //used to turn the robot over an external center of rotation.

bool  edgeLeft = false,
      lineLeft = false,
      lineCenter = false,
      lineRight = false,
      edgeRight = false;

void readSensors()
{
  //each sensor is 1 if reading white, and 0 if reading black:
  edgeLeft =  sparki.edgeLeft() &gt; threshold;
  lineLeft =  sparki.lineLeft() &gt; threshold;
  lineCenter = sparki.lineCenter() &gt; threshold;
  lineRight =  sparki.lineRight() &gt; threshold;
  edgeRight = sparki.edgeRight() &gt; threshold;
}

void moveLeft()
{
  //turn left at a lower speed:
  sparki.motorRotate(MOTOR_LEFT, DIR_CCW, turnSpeed);
  sparki.motorRotate(MOTOR_RIGHT, DIR_CW, 100);
}

void moveRight()
{
  //turn right at a lower speed:
  sparki.motorRotate(MOTOR_LEFT, DIR_CCW, 100);
  sparki.motorRotate(MOTOR_RIGHT, DIR_CW, turnSpeed);
}

void followLine()
{
  if (lineLeft &amp;&amp; !lineRight) //lineLeft detects white and at least lineRight detects black.
  {
    moveRight();
  }
  else if (!lineLeft &amp;&amp; lineRight) //lineRight detects white and at least lineLeft detects black.
  {
    moveLeft();
  }
  else if (!lineLeft &amp;&amp; !lineCenter &amp;&amp; !lineRight) //lineLeft, lineCenter and lineRight detects black.
  {
    sparki.moveForward();
  }
}

void setup()
{
  //indicates to the user that the program started:
  sparki.beep(440, 300);
  delay(300);
  sparki.beep(880, 500);
}

void loop()
{
  readSensors();

  followLine();
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-10">10</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-12">12</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-14">14</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-16">16</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-18">18</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-20">20</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-22">22</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-24">24</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-26">26</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-28">28</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-30">30</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-32">32</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-34">34</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-36">36</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-38">38</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-40">40</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-42">42</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-44">44</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-46">46</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-48">48</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-50">50</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-52">52</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-54">54</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-56">56</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-58">58</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-60">60</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-62">62</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f212f453113443-64">64</div><div class="crayon-num" data-line="crayon-54e6e132f212f453113443-65">65</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f212f453113443-1"><span class="crayon-p">#include &lt;Sparki.h&gt; // include the sparki library</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-2">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f212f453113443-3"><span class="crayon-r">const</span><span class="crayon-h"> </span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//line sensors thereshold.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-4"><span class="crayon-r">const</span><span class="crayon-h"> </span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">turnSpeed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//used to turn the robot over an external center of rotation.</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-6"><span class="crayon-i">bool</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">edgeRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-12"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">readSensors</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-13"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//each sensor is 1 if reading white, and 0 if reading black:</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">edgeLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineCenter</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">edgeRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-20"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-22"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-23"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//turn left at a lower speed:</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_LEFT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CCW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">turnSpeed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_RIGHT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-27"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-28">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f212f453113443-29"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-30"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//turn right at a lower speed:</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_LEFT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CCW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-33"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_RIGHT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">turnSpeed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-34"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-36"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">followLine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-37"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineLeft detects white and at least lineRight detects black.</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-42"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineRight detects white and at least lineLeft detects black.</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-43"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-45"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-46"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineLeft, lineCenter and lineRight detects black.</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-47"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-49"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-50"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-52"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-st">setup</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-53"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-54"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//indicates to the user that the program started:</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-55"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-cn">440</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-56"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-57"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-cn">880</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-58"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-59">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-60"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-st">loop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-61"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-62"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">readSensors</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-63">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f212f453113443-64"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">followLine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f212f453113443-65"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p><a href="https://github.com/ArcBotics/Sparki/blob/master/Lessons/SparkiDuino/mazeSolving/lineFollower2.zip?raw=true" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://github.com&#39;]);"><img class="aligncenter" title="" alt="" src="./Maze Solving_files/btnDownloadCode.png"></a></p>
<p>If you test this code with your Sparki, it will not solve the maze (since it will ignore the branches and dead ends), but you will see how it keeps centered following the line. Or course, once it reaches a 90 degrees corner, it will be lost. &nbsp;But this <strong>auto centering</strong> is enough to trust that Sparki will advance straight through this dangerous maze.</p>
<p>And before moving on, let’s analyze the code a bit deeper. As you can see, the line following algorithm is coded inside a <a href="http://arcbotics.com/lessons/functions/">function</a>. We did this because this function will become part of the bigger maze solver program soon. And since this will be a complex program (if you compare it with most programs in the previous lessons), we will be relying a lot on small functions.</p>
<p>Another interesting function here is&nbsp;<strong>readSensors</strong>:</p> 
<div id="crayon-54e6e132f2146099199209" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">void readSensors()
{
  //each sensor is 1 if reading white, and 0 if reading black:
  edgeLeft =  sparki.edgeLeft() &gt; threshold;
  lineLeft =  sparki.lineLeft() &gt; threshold;
  lineCenter = sparki.lineCenter() &gt; threshold;
  lineRight =  sparki.lineRight() &gt; threshold;
  edgeRight = sparki.edgeRight() &gt; threshold;
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2146099199209-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2146099199209-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2146099199209-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2146099199209-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2146099199209-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2146099199209-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f2146099199209-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2146099199209-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f2146099199209-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2146099199209-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">readSensors</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2146099199209-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2146099199209-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//each sensor is 1 if reading white, and 0 if reading black:</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2146099199209-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">edgeLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2146099199209-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2146099199209-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineCenter</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2146099199209-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2146099199209-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">edgeRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2146099199209-9"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>This function encapsulates inside all the functionality needed to read all the sensors at once, compares them against a threshold (which is defined as a global constant) and stores the results in <a href="http://en.wikipedia.org/wiki/Boolean_expression" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">Boolean</a> variables, which will be useful to make all the code from now on shorter (specially the comparisons for the sensors values).</p>
<p>And finally, &nbsp;there are two other interesting small functions here: <strong>moveLeft</strong> and <strong>moveRight</strong>:</p> 
<div id="crayon-54e6e132f214c208010309" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">void moveLeft()
{
  //turn left at a lower speed:
  sparki.motorRotate(MOTOR_LEFT, DIR_CCW, turnSpeed);
  sparki.motorRotate(MOTOR_RIGHT, DIR_CW, 100);
}

void moveRight()
{
  //turn right at a lower speed:
  sparki.motorRotate(MOTOR_LEFT, DIR_CCW, 100);
  sparki.motorRotate(MOTOR_RIGHT, DIR_CW, turnSpeed);
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f214c208010309-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f214c208010309-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f214c208010309-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f214c208010309-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f214c208010309-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f214c208010309-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f214c208010309-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f214c208010309-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f214c208010309-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f214c208010309-10">10</div><div class="crayon-num" data-line="crayon-54e6e132f214c208010309-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f214c208010309-12">12</div><div class="crayon-num" data-line="crayon-54e6e132f214c208010309-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f214c208010309-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f214c208010309-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f214c208010309-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//turn left at a lower speed:</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f214c208010309-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_LEFT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CCW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">turnSpeed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f214c208010309-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_RIGHT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f214c208010309-6"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f214c208010309-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f214c208010309-8"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f214c208010309-9"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f214c208010309-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//turn right at a lower speed:</span></div><div class="crayon-line" id="crayon-54e6e132f214c208010309-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_LEFT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CCW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f214c208010309-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_RIGHT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">turnSpeed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f214c208010309-13"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>As you can see in the code, these functions enable the Sparki to turn smoother than using&nbsp;<a href="http://arcbotics.com/products/sparki/parts/wheels/">sparki.moveLeft and sparki.moveRight</a>, since they rotate the robot around an external center of rotation:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/moveLeftmoveRight.png"></p>
<p>&nbsp;</p>
<h3>Detecting Branches and Dead Ends</h3>
<p>Now that our Sparki is capable of going straight inside the maze, let’s manage our next problem: detecting the left branches, right branches and dead ends. &nbsp;We do this using the&nbsp;<strong>infrared reflectance&nbsp;sensors</strong>. Because we are arriving head-on to a branch (with Sparki at a right-angle to it), we can tell what kind of branch it is based on which sensors are activated.</p>
<p>If the Line Right and Edge Right sensors are detecting black, we are at a right branch.&nbsp;If the Line Left and Edge Left sensors are detecting black, we are at a right branch:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/branchSensorStates1.png"></p>
<p>So, these two small <a title="Functions" href="http://arcbotics.com/lessons/functions/">functions</a> will tell us if there are branches underneath Sparki, using <a title="Controls" href="http://arcbotics.com/lessons/controls/">controls</a>:</p> 
<div id="crayon-54e6e132f2152104580299" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">bool isThereALeftBranch()
{
  //both left sensors read black:
  return !lineLeft &amp;&amp; !edgeLeft;
}

bool isThereARightBranch()
{
  //both right sensors read black:
  return !lineRight &amp;&amp; !edgeRight;
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2152104580299-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2152104580299-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2152104580299-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2152104580299-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2152104580299-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2152104580299-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f2152104580299-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2152104580299-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f2152104580299-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2152104580299-10">10</div><div class="crayon-num" data-line="crayon-54e6e132f2152104580299-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2152104580299-1"><span class="crayon-i">bool</span><span class="crayon-h"> </span><span class="crayon-v">isThereALeftBranch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2152104580299-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2152104580299-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//both left sensors read black:</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2152104580299-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeLeft</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2152104580299-5"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2152104580299-6">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2152104580299-7"><span class="crayon-i">bool</span><span class="crayon-h"> </span><span class="crayon-v">isThereARightBranch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2152104580299-8"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2152104580299-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//both right sensors read black:</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2152104580299-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2152104580299-11"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>And what about dead ends? It’s also easy because if <strong>all</strong> the sensors are detecting white underneath the robot, it’s because it has reached a dead end:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/deadEndSensorStates.png"></p>
<p>&nbsp;</p>
<p>The code for the <strong>isThereADeadEnd</strong> function is as follows:</p> 
<div id="crayon-54e6e132f2157867316964" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">bool isThereADeadEnd()
{
  //all sensors read white:
  return edgeLeft &amp;&amp; lineLeft &amp;&amp; lineCenter &amp;&amp; lineRight &amp;&amp; edgeRight;
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2157867316964-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2157867316964-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2157867316964-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2157867316964-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2157867316964-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2157867316964-1"><span class="crayon-i">bool</span><span class="crayon-h"> </span><span class="crayon-v">isThereADeadEnd</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2157867316964-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2157867316964-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//all sensors read white:</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2157867316964-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">edgeRight</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2157867316964-5"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>&nbsp;</p>
<h3>Looking Inside Sparki</h3>
<p>Before going further with our program, it’s important to be aware of what’s happening inside Sparki. Thus, if something goes wrong, fixing it will be easier. And if everything works just fine, knowing in real time what the sensor values are will always help us to have a better understanding of the inner workings of the program.</p>
<p>First, we will declare a&nbsp;<a href="http://arduino.cc/en/Reference/StringObject" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://arduino.cc&#39;]);" target="_blank">string</a>&nbsp;(global) variable to keep track of the robot state:</p> 
<div id="crayon-54e6e132f215c368628578" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">String state = "undefined";</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f215c368628578-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f215c368628578-1"><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"undefined"</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>And what is the robot state? It’s just a concept that we use to help us understand what’s going on. For example, if the robot is advancing straight, the state will be&nbsp;<strong>“follow line”</strong>. If it has just detected a left branch, its state will become&nbsp;<strong>“turn left”</strong>. As we will see soon, the <strong>state</strong> variable will be updated along the maze solving program.</p>
<p>Here are all the states that our final program will have:</p>
<ul>
<li><strong>undefined</strong>: this is the initial state, when the robot has not yet even started to follow a line.</li>
<li><strong>centering</strong>: at the beginning of the program, the robot waits until the user centers it over the maze line manually. We will talk more about this soon.</li>
<li><strong>follow line</strong>: the robot started to go straight.</li>
<li><strong>turn left</strong>: the robot has detected a left branch, and it’s trying to take it.</li>
<li><strong>turn right</strong>: the robot has detected a right branch, and it’s trying to take it.</li>
<li><strong>turn back</strong>: the robot has detected a dead end, and is turning around.</li>
<li><strong>maze solved!</strong>: the robot has detected the end mark, so the program has finished its work.</li>
</ul>
<p>That said, let’s define a helper function that will make use of the <a href="http://arcbotics.com/products/sparki/parts/lcd/">LCD Display</a> to tell us what’s happening with the infrared sensors and with Sparki’s internal state:</p> 
<div id="crayon-54e6e132f2162437051008" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">void showSensorsAndState()
{
  sparki.clearLCD();

  sparki.print("eL = ");
  sparki.println(edgeLeft);
  sparki.print("lL = ");
  sparki.println(lineLeft);
  sparki.print("lC = ");
  sparki.println(lineCenter);
  sparki.print("lR = ");
  sparki.println(lineRight);
  sparki.print("eR = ");
  sparki.println(edgeRight);
  sparki.println();
  sparki.println(String("state = ") + state);

  sparki.updateLCD();
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-10">10</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-12">12</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-14">14</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-16">16</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2162437051008-18">18</div><div class="crayon-num" data-line="crayon-54e6e132f2162437051008-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2162437051008-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">showSensorsAndState</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2162437051008-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">clearLCD</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-4">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2162437051008-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"eL = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">edgeLeft</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2162437051008-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"lL = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">lineLeft</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2162437051008-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"lC = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">lineCenter</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2162437051008-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"lR = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2162437051008-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"eR = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2162437051008-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-sy">(</span><span class="crayon-s">"state = "</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2162437051008-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2162437051008-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">updateLCD</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2162437051008-19"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>By calling this function periodically, it will update the LCD Display with the latest values.</p>
<p>&nbsp;</p>
<h3>Turning Left and Right</h3>
<p>Let’s talk about what happens when the robot detects a branch. As you may have noted, the <strong>edge sensors</strong> are approximately 4.3 cm from the robot’s wheel shafts (towards the robot’s front):</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/lineSensorDistance.png"></p>
<p>So, the robot can see the branches about 4.3 cm&nbsp;before the the wheels are there. This means that in order to let the robot turn correctly over the branch (and not sooner, nor later), once it detects the branch, it still has to move those 4.3 cm. But moving just that distance will mean that the robot’s shafts will be collinear&nbsp;with the <em>edge of the branch.&nbsp;</em>What we want is to have the robot’s shafts aligned with the <em>center of the branch</em>, allowing our Sparki to rotate around its own rotation center to continue over the black line of the branch. So that’s why the program does not just make Sparki move forward 4.3 cm, but about 7 cm instead. You may try other values as well, to improve the way Sparki interacts with maze branches.</p>
<p>This is why we need the <strong>turnLeft</strong> and <strong>turnRight</strong> functions here. They will be used when the robot detects a branch. In the code below, the robot goes forward a small distance, then turns so many degrees, and then centers the robot again in the line. You can change how much Sparki moves forward and turns by changing <strong>sensorsDistance</strong> and <strong>outOfTheLineAngle</strong>, both of which are constants named at the beginning of the whole program.&nbsp;Sparki will now be the line belonging to the branch. These are the functions:</p> 
<div id="crayon-54e6e132f2168714720708" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">void turnLeft()
{
  state = "turn left";
  sparki.moveForward(sensorsDistance);
  sparki.moveLeft(outOfTheLineAngle);
  sparki.moveLeft(); //turn left until the robot is centered.
  centerRobot();
}

void turnRight()
{
  state = "turn right";
  sparki.moveForward(sensorsDistance);
  sparki.moveRight(outOfTheLineAngle);
  sparki.moveRight(); //turn right until the robot is centered.
  centerRobot();
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2168714720708-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2168714720708-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2168714720708-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2168714720708-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2168714720708-10">10</div><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2168714720708-12">12</div><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2168714720708-14">14</div><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2168714720708-16">16</div><div class="crayon-num" data-line="crayon-54e6e132f2168714720708-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2168714720708-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">turnLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2168714720708-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2168714720708-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"turn left"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2168714720708-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-v">sensorsDistance</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2168714720708-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-v">outOfTheLineAngle</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2168714720708-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//turn left until the robot is centered.</span></div><div class="crayon-line" id="crayon-54e6e132f2168714720708-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2168714720708-8"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2168714720708-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2168714720708-10"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">turnRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2168714720708-11"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2168714720708-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"turn right"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2168714720708-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-v">sensorsDistance</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2168714720708-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-v">outOfTheLineAngle</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2168714720708-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//turn right until the robot is centered.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2168714720708-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2168714720708-17"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>If you don’t know why the robot needs to turn the fixed <strong>outOfTheLineAngle</strong> value, try commenting those lines in the final version of this program (below) and see what happens.</p>
<p>Now, let’s try to see how Sparki is centered. The <strong>centerRobot</strong> function just leaves the robot in its last moving state (for example, rotating to the left in the <strong>turnLeft</strong> function explained above) until the robot is centered again in a line. To do this, this function uses a <a href="http://arcbotics.com/lessons/controls/while-statements/">while</a> cycle, calling the function <strong>robotIsNotCentered</strong> on each iteration:</p> 
<div id="crayon-54e6e132f216d680933318" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">void centerRobot()
{
  while(robotIsNotCentered())
  {
    readSensors();
    showSensorsAndState();
  }
  sparki.beep();
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f216d680933318-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f216d680933318-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f216d680933318-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f216d680933318-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f216d680933318-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f216d680933318-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f216d680933318-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f216d680933318-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f216d680933318-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f216d680933318-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f216d680933318-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f216d680933318-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-v">robotIsNotCentered</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f216d680933318-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f216d680933318-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">readSensors</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f216d680933318-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">showSensorsAndState</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f216d680933318-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f216d680933318-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f216d680933318-9"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>Here is the code for the&nbsp;<strong>robotIsNotCentered</strong>&nbsp;function:</p> 
<div id="crayon-54e6e132f2172449743110" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">bool robotIsNotCentered()
{
  //when centered, the lineLeft, lineCenter and lineRight sensors read black (using De Morgan here):
  return !edgeLeft || lineLeft || lineCenter || lineRight || !edgeRight;
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2172449743110-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2172449743110-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2172449743110-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2172449743110-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2172449743110-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2172449743110-1"><span class="crayon-i">bool</span><span class="crayon-h"> </span><span class="crayon-v">robotIsNotCentered</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2172449743110-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2172449743110-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//when centered, the lineLeft, lineCenter and lineRight sensors read black (using De Morgan here):</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2172449743110-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2172449743110-5"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>This function returns true if the robot is not centered, and obviously it returns false when its finally centered. Defining it this way, the <strong>while</strong> cycle on the centerRobot function continues until the robot is effectively centered.</p>
<h3>Turning Around</h3>
<p>Dealing with dead ends is quite similar to dealing with left or right branches. In this case, Sparki just needs to turn in one direction (could be left or right) until it centers itself again on its way over the black line.&nbsp;The code is pretty simple:</p> 
<div id="crayon-54e6e132f2177430092016" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">void turnBack()
{
  state = "turn back";
  sparki.moveForward(sensorsDistance);
  sparki.moveLeft(); //turn left until the robot is centered.
  centerRobot();
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2177430092016-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2177430092016-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2177430092016-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2177430092016-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2177430092016-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2177430092016-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f2177430092016-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2177430092016-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">turnBack</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2177430092016-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2177430092016-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"turn back"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2177430092016-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-v">sensorsDistance</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2177430092016-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//turn left until the robot is centered.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2177430092016-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2177430092016-7"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>&nbsp;</p>
<h3>Detecting the End Mark</h3>
<p>Before finally coding the main loop for this program there is a small modification to be done to the <strong>followLine</strong> function, so it can detect the maze’s end mark. The mark is easily detected because is the only situation in our maze when the <strong>Line Center Sensor</strong> read white and both the <strong>Edge Left</strong> and <strong>Edge Left</strong> sensors read black at the same time (except for double branches, but when that happens, the detection of the left branch has priority over the dead end detection, so the robot just turn left on those cases):</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/endMarkSensorsState.png"></p>
<p>Once this condition is detected, the maze is solved, and the program will call to the <strong>mazeSolved</strong> function (which is explained below). After that, the program will have Sparki wait until the next reset or power down /power up cycle, using a&nbsp;<strong>while(true)</strong>. Here is the final <strong>followLine</strong> function:</p> 
<div id="crayon-54e6e132f217c410486675" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">void followLine()
{
  state = "follow line";
  if (lineLeft &amp;&amp; !lineRight) //lineLeft detects white and at least lineRight detects black.
  {
    moveRight();
  }
  else if (!lineLeft &amp;&amp; lineRight) //lineRight detects white and at least lineLeft detects black.
  {
    moveLeft();
  }
  else if (!lineLeft &amp;&amp; !lineCenter &amp;&amp; !lineRight) //lineLeft, lineCenter and lineRight detects black.
  {
    sparki.moveForward();
  }
  else if (isThereADeadEnd())
  {
    turnBack();
  }
  else if (!edgeLeft &amp;&amp; lineCenter &amp;&amp; !edgeRight) //black-white-black is the mark present on the maze's end.
  {
    mazeSolved();
    while(true); //maze solved! =&gt; program ends here!
  }
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-10">10</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-12">12</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-14">14</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-16">16</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-18">18</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-20">20</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-22">22</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f217c410486675-24">24</div><div class="crayon-num" data-line="crayon-54e6e132f217c410486675-25">25</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f217c410486675-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">followLine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"follow line"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineLeft detects white and at least lineRight detects black.</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineRight detects white and at least lineLeft detects black.</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineLeft, lineCenter and lineRight detects black.</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">isThereADeadEnd</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">turnBack</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//black-white-black is the mark present on the maze's end.</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mazeSolved</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-k">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//maze solved! =&gt; program ends here!</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f217c410486675-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f217c410486675-25"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>&nbsp;</p>
<h3>The Main Application Loop</h3>
<p>Now that we have written all the previous code, creating the main application loop is straightforward. And it’s finally here where we can see the <a href="http://en.wikipedia.org/wiki/Maze_solving_algorithm#Wall_follower" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">Wall Follower algorithm</a>&nbsp;implemented, as it was described above in this same lesson:</p> 
<div id="crayon-54e6e132f2181902110206" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">void loop()
{
  readSensors();

  followLine();
  if (isThereALeftBranch())
  {
    turnLeft();
  }
  else if (isThereARightBranch())
  {
    turnRight();
  }
  showSensorsAndState();
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2181902110206-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2181902110206-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2181902110206-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2181902110206-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2181902110206-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2181902110206-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f2181902110206-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2181902110206-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f2181902110206-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2181902110206-10">10</div><div class="crayon-num" data-line="crayon-54e6e132f2181902110206-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2181902110206-12">12</div><div class="crayon-num" data-line="crayon-54e6e132f2181902110206-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2181902110206-14">14</div><div class="crayon-num" data-line="crayon-54e6e132f2181902110206-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2181902110206-1"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-st">loop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2181902110206-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2181902110206-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">readSensors</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2181902110206-4">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2181902110206-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">followLine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2181902110206-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">isThereALeftBranch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2181902110206-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2181902110206-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">turnLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2181902110206-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2181902110206-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">isThereARightBranch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2181902110206-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2181902110206-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">turnRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2181902110206-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2181902110206-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">showSensorsAndState</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2181902110206-15"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p>&nbsp;</p>
<h2>The Final Code</h2>
<p>Let’s put all the pieces together in the final program! It will enable Sparki to solve the maze. Also, you will see the <strong>mazeSolved</strong> function here, which just stops the robot, changes its state to “maze solved!” and emits some sounds to tell the user about the success. One last comment before testing the program: if you take a look to the <strong>setup</strong> function, on the program start, Sparki will wait until you, the user, manually centers it on the starting line before moving to escape from the maze:</p> 
<div id="crayon-54e6e132f2186203325705" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">/*******************************************
 Maze Solver

 Sparki has an array of infrared sensors
 underneath. It can use these to solve
 a printed maze. More info on the following
 link: 

 http://arcbotics.com/lessons/maze-solving/

********************************************/

#include &lt;Sparki.h&gt; // include the sparki library

const int threshold = 500; //line sensors thereshold.
const int sensorsDistance = 7; //distance [cm] between the line sensor and the wheels centers plus half the width of the black line.
const int turnSpeed = 40; //used to turn the robot over an external center of rotation.
const int outOfTheLineAngle = 30; //used to go outside the line and then find the branches.

bool  edgeLeft = false,
      lineLeft = false,
      lineCenter = false,
      lineRight = false,
      edgeRight = false;

String state = "undefined";

void readSensors()
{
  //each sensor is 1 if reading white, and 0 if reading black:
  edgeLeft =  sparki.edgeLeft() &gt; threshold;
  lineLeft =  sparki.lineLeft() &gt; threshold;
  lineCenter = sparki.lineCenter() &gt; threshold;
  lineRight =  sparki.lineRight() &gt; threshold;
  edgeRight = sparki.edgeRight() &gt; threshold;
}

void showSensorsAndState()
{
  sparki.clearLCD();

  sparki.print("eL = ");
  sparki.println(edgeLeft);
  sparki.print("lL = ");
  sparki.println(lineLeft);
  sparki.print("lC = ");
  sparki.println(lineCenter);
  sparki.print("lR = ");
  sparki.println(lineRight);
  sparki.print("eR = ");
  sparki.println(edgeRight);
  sparki.println();
  sparki.println(String("state = ") + state);

  sparki.updateLCD();
}

void moveLeft()
{
  //turn left at a lower speed:
  sparki.motorRotate(MOTOR_LEFT, DIR_CCW, turnSpeed);
  sparki.motorRotate(MOTOR_RIGHT, DIR_CW, 100);
}

void moveRight()
{
  //turn right at a lower speed:
  sparki.motorRotate(MOTOR_LEFT, DIR_CCW, 100);
  sparki.motorRotate(MOTOR_RIGHT, DIR_CW, turnSpeed);
}

bool robotIsNotCentered()
{
  //when centered, the lineLeft, lineCenter and lineRight sensors read black (using De Morgan here):
  return !edgeLeft || lineLeft || lineCenter || lineRight || !edgeRight;
}

bool isThereALeftBranch()
{
  //both left sensors read black:
  return !lineLeft &amp;&amp; !edgeLeft;
}

bool isThereARightBranch()
{
  //both right sensors read black:
  return !lineRight &amp;&amp; !edgeRight;
}

bool isThereADeadEnd()
{
  //all sensors read white:
  return edgeLeft &amp;&amp; lineLeft &amp;&amp; lineCenter &amp;&amp; lineRight &amp;&amp; edgeRight;
}

void centerRobot()
{
  while(robotIsNotCentered())
  {
    readSensors();
    showSensorsAndState();
  }
  sparki.beep();
}

void turnLeft()
{
  state = "turn left";
  sparki.moveForward(sensorsDistance);
  sparki.moveLeft(outOfTheLineAngle);
  sparki.moveLeft(); //turn left until the robot is centered.
  centerRobot();
}

void turnRight()
{
  state = "turn right";
  sparki.moveForward(sensorsDistance);
  sparki.moveRight(outOfTheLineAngle);
  sparki.moveRight(); //turn right until the robot is centered.
  centerRobot();
}

void turnBack()
{
  state = "turn back";
  sparki.moveForward(sensorsDistance);
  sparki.moveLeft(); //turn left until the robot is centered.
  centerRobot();
}

void mazeSolved()
{
  //tells the user that the maze was solved!
  state = "maze solved!";
  sparki.moveStop();
  showSensorsAndState();
  sparki.beep(880, 300);
  delay(300);
  sparki.beep(440, 300);
  delay(300);
  sparki.beep(880, 600);
  delay(600);
}

void followLine()
{
  state = "follow line";
  if (lineLeft &amp;&amp; !lineRight) //lineLeft detects white and at least lineRight detects black.
  {
    moveRight();
  }
  else if (!lineLeft &amp;&amp; lineRight) //lineRight detects white and at least lineLeft detects black.
  {
    moveLeft();
  }
  else if (!lineLeft &amp;&amp; !lineCenter &amp;&amp; !lineRight) //lineLeft, lineCenter and lineRight detects black.
  {
    sparki.moveForward();
  }
  else if (isThereADeadEnd())
  {
    turnBack();
  }
  else if (!edgeLeft &amp;&amp; lineCenter &amp;&amp; !edgeRight) //black-white-black is the mark present on the maze's end.
  {
    mazeSolved();
    while(true); //maze solved! =&gt; program ends here!
  }
}

void setup()
{
  //indicates to the user that the program started:
  sparki.beep(440, 300);
  delay(300);
  sparki.beep(880, 500);

  //now the user has to center de robot manually, with
  //the lineCenter sensor over the black maze line:
  state = "centering";
  centerRobot();
}

void loop()
{
  readSensors();

  followLine();
  if (isThereALeftBranch())
  {
    turnLeft();
  }
  else if (isThereARightBranch())
  {
    turnRight();
  }
  showSensorsAndState();
}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-2">2</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-4">4</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-6">6</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-8">8</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-10">10</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-12">12</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-14">14</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-16">16</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-18">18</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-20">20</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-22">22</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-24">24</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-26">26</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-28">28</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-30">30</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-32">32</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-34">34</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-36">36</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-38">38</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-40">40</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-42">42</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-44">44</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-46">46</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-48">48</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-50">50</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-52">52</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-54">54</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-56">56</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-58">58</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-60">60</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-62">62</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-64">64</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-66">66</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-68">68</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-70">70</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-72">72</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-74">74</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-76">76</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-78">78</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-80">80</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-82">82</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-84">84</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-86">86</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-88">88</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-90">90</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-92">92</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-94">94</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-96">96</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-98">98</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-100">100</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-102">102</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-104">104</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-106">106</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-108">108</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-110">110</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-112">112</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-114">114</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-116">116</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-118">118</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-120">120</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-122">122</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-124">124</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-126">126</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-128">128</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-130">130</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-132">132</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-134">134</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-136">136</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-138">138</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-140">140</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-142">142</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-144">144</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-146">146</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-148">148</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-150">150</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-152">152</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-154">154</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-156">156</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-158">158</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-160">160</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-162">162</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-164">164</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-166">166</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-168">168</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-170">170</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-172">172</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-174">174</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-176">176</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-178">178</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-180">180</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-182">182</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-184">184</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-186">186</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-188">188</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-190">190</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-192">192</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-194">194</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-196">196</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-54e6e132f2186203325705-198">198</div><div class="crayon-num" data-line="crayon-54e6e132f2186203325705-199">199</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-line" id="crayon-54e6e132f2186203325705-1"><span class="crayon-c">/*******************************************</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-2"><span class="crayon-c"> Maze Solver</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-4"><span class="crayon-c"> Sparki has an array of infrared sensors</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-5"><span class="crayon-c"> underneath. It can use these to solve</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-6"><span class="crayon-c"> a printed maze. More info on the following</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-7"><span class="crayon-c"> link: </span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-8">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-9"><span class="crayon-c"> http://arcbotics.com/lessons/maze-solving/</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-10">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-11"><span class="crayon-c">********************************************/</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-12">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-13"><span class="crayon-p">#include &lt;Sparki.h&gt; // include the sparki library</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-14">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-15"><span class="crayon-r">const</span><span class="crayon-h"> </span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//line sensors thereshold.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-16"><span class="crayon-r">const</span><span class="crayon-h"> </span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">sensorsDistance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//distance [cm] between the line sensor and the wheels centers plus half the width of the black line.</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-17"><span class="crayon-r">const</span><span class="crayon-h"> </span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">turnSpeed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//used to turn the robot over an external center of rotation.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-18"><span class="crayon-r">const</span><span class="crayon-h"> </span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">outOfTheLineAngle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//used to go outside the line and then find the branches.</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-20"><span class="crayon-i">bool</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">edgeRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-26"><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"undefined"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-28"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">readSensors</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-29"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//each sensor is 1 if reading white, and 0 if reading black:</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">edgeLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-33"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineCenter</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-34"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">lineRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">edgeRight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-36"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-38"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">showSensorsAndState</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-39"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-40"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">clearLCD</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-42"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"eL = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-43"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">edgeLeft</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-44"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"lL = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-45"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">lineLeft</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-46"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"lC = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-47"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">lineCenter</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-48"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"lR = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-49"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-50"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"eR = "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-51"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-52"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-53"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-sy">(</span><span class="crayon-s">"state = "</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-54">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-55"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">updateLCD</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-56"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-57">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-58"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-59"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-60"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//turn left at a lower speed:</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-61"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_LEFT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CCW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">turnSpeed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-62"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_RIGHT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-63"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-64">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-65"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-66"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-67"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//turn right at a lower speed:</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-68"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_LEFT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CCW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-69"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">motorRotate</span><span class="crayon-sy">(</span><span class="crayon-v">MOTOR_RIGHT</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">DIR_CW</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">turnSpeed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-70"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-72"><span class="crayon-i">bool</span><span class="crayon-h"> </span><span class="crayon-v">robotIsNotCentered</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-73"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-74"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//when centered, the lineLeft, lineCenter and lineRight sensors read black (using De Morgan here):</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-75"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-76"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-77">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-78"><span class="crayon-i">bool</span><span class="crayon-h"> </span><span class="crayon-v">isThereALeftBranch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-79"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-80"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//both left sensors read black:</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-81"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeLeft</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-82"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-83">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-84"><span class="crayon-i">bool</span><span class="crayon-h"> </span><span class="crayon-v">isThereARightBranch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-85"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-86"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//both right sensors read black:</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-87"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-88"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-90"><span class="crayon-i">bool</span><span class="crayon-h"> </span><span class="crayon-v">isThereADeadEnd</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-91"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-92"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//all sensors read white:</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-93"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineRight</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">edgeRight</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-94"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-95">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-96"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-97"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-98"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-v">robotIsNotCentered</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-99"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-100"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">readSensors</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-101"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">showSensorsAndState</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-102"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-103"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-104"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-105">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-106"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">turnLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-107"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-108"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"turn left"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-109"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-v">sensorsDistance</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-110"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-v">outOfTheLineAngle</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-111"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//turn left until the robot is centered.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-112"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-113"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-114">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-115"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">turnRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-116"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-117"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"turn right"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-118"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-v">sensorsDistance</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-119"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-v">outOfTheLineAngle</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-120"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//turn right until the robot is centered.</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-121"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-122"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-123">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-124"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">turnBack</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-125"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-126"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"turn back"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-127"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-v">sensorsDistance</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-128"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//turn left until the robot is centered.</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-129"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-130"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-131">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-132"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">mazeSolved</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-133"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-134"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//tells the user that the maze was solved!</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-135"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"maze solved!"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-136"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveStop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-137"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">showSensorsAndState</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-138"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-cn">880</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-139"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-140"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-cn">440</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-141"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-142"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-cn">880</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">600</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-143"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">600</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-144"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-145">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-146"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-v">followLine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-147"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-148"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"follow line"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-149"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineLeft detects white and at least lineRight detects black.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-150"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-151"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">moveRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-152"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-153"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineRight detects white and at least lineLeft detects black.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-154"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-155"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">moveLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-156"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-157"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">lineLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">lineRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//lineLeft, lineCenter and lineRight detects black.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-158"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-159"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">moveForward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-160"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-161"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">isThereADeadEnd</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-162"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-163"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">turnBack</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-164"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-165"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">edgeLeft</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">lineCenter</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-v">edgeRight</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">//black-white-black is the mark present on the maze's end.</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-166"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-167"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mazeSolved</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-168"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-k">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//maze solved! =&gt; program ends here!</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-169"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-170"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-171">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-172"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-st">setup</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-173"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-174"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//indicates to the user that the program started:</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-175"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-cn">440</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-176"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-177"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sparki</span><span class="crayon-sy">.</span><span class="crayon-v">beep</span><span class="crayon-sy">(</span><span class="crayon-cn">880</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-178">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-179"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//now the user has to center de robot manually, with</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-180"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">//the lineCenter sensor over the black maze line:</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-181"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"centering"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-182"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">centerRobot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-183"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-184">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-185"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-st">loop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-186"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-187"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">readSensors</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-188">&nbsp;</div><div class="crayon-line" id="crayon-54e6e132f2186203325705-189"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">followLine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-190"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">isThereALeftBranch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-191"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-192"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">turnLeft</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-193"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-194"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">isThereARightBranch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-195"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-196"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">turnRight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-197"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-54e6e132f2186203325705-198"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">showSensorsAndState</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-54e6e132f2186203325705-199"><span class="crayon-sy">}</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
 
<p></p>
<p style="text-align: left;"><a href="https://github.com/ArcBotics/Sparki/blob/master/Lessons/SparkiDuino/mazeSolving/mazeSolver1.zip?raw=true" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://github.com&#39;]);"><img class="aligncenter" title="" alt="" src="./Maze Solving_files/btnDownloadCode.png"></a></p>
<p>Congratulations! Your Sparki is now capable of spectacular maze breakaways.</p>
<p>&nbsp;</p>
<h2>Extra Activities</h2>
<p>As you may have seen in the <a href="http://en.wikipedia.org/wiki/Maze_solving_algorithm" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">maze solving programs link</a> above, there are other ways of solving a maze. Why not try some of them, like the <a href="http://en.wikipedia.org/wiki/Maze_solving_algorithm#Random_mouse_algorithm" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://en.wikipedia.org&#39;]);" target="_blank">Random mouse algorithm</a>&nbsp;(<em><strong>Tip:</strong></em>&nbsp;Remember that you can use the <a href="http://arduino.cc/en/reference/random" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://arduino.cc&#39;]);" target="_blank">random function</a> included in Sparki’s software)? You can also run an Internet search to find more information on how other people program robots to win maze competitions, for example.</p>
<p>Finally, there are other kinds of printed mazes like the&nbsp;one included with the&nbsp;<a href="http://www.arcbotics.mybigcommerce.com/sparki-materials-pack/" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://www.arcbotics.mybigcommerce.com&#39;]);">Sparki Materials Pack</a>:</p>
<p><img class="aligncenter" title="" alt="" src="./Maze Solving_files/Thumb-Sparki-Poster-Maze.png"></p>
<p>Do you think that you can program your Sparki to solve it?</p>
<div class="clear_space"></div>
</div>
 
 
<div id="page_right">
<div class="box middle"><div class="textarea"><hr>
<h3><a id="HowToUseSparki"></a><span style="color: #808080;"><strong></strong><strong>How to Use Sparki</strong></span></h3>
<hr>
<h5><a title="Getting Started with Sparki" href="http://arcbotics.com/products/sparki/start/">Getting Started with Sparki</a></h5>
<p style="padding-left: 20px; padding-bottom: 5px;"><a title="SparkiDuino OSX Install Guide" href="http://arcbotics.com/lessons/sparkiduino-osx-install-guide/">SparkiDuino OSX Install</a><br>
<a title="SparkiDuino Windows Install Guide" href="http://arcbotics.com/lessons/sparkiduino-windows-install-guide/">SparkiDuino Windows Install</a></p>
<p><a title="Using the Remote" href="http://arcbotics.com/using-remote/">Testing your Sparki: Using the Remote</a><br>
<a title="How to Upload Sparki Code" href="http://arcbotics.com/sparki-lessons/how-to-upload-sparki-code/">How to Upload Sparki Code</a><br>
<a title="Manually Upload Code" href="http://arcbotics.com/lessons/manual-upload/">Manually Uploading Code</a><br>
<a title="Bluetooth Module" href="http://arcbotics.com/products/sparki/parts/bluetooth-module/">Installing the Bluetooth</a><br>
 <a href="http://arcbotics.com/lessons/troubleshooting/">Sparki Troubleshooting</a></p>
<hr>
<h3><a id="RoboticsLessons"></a><span style="color: #808080;"><strong></strong><strong>Robotics Lessons</strong></span></h3>
<hr>
<h5><a href="http://arcbotics.com/basic-sparkiduino-lessons/">Basic SparkiDuino Lessons</a></h5>
<p><a title="Moving the Robot" href="http://arcbotics.com/lessons/moving-the-robot/">Moving the Robot</a><br>
<a href="http://arcbotics.com/lessons/mixing-colors-with-the-rgb-led/">Mixing Colors with the RGB LED</a><br>
<a href="http://arcbotics.com/lessons/melody/">Making Sounds</a><br>
<a href="http://arcbotics.com/lessons/first-steps-with-the-lcd-display/">First Steps with the LCD Display</a><br>
<a href="http://arcbotics.com/lessons/using-the-ultrasonic-distance-sensor/">Using the Ultrasonic Distance Sensor</a><br>
<a title="Wall Avoidance" href="http://arcbotics.com/lessons/wall-avoidance/">Wall Avoidance</a><br>
<a href="http://arcbotics.com/lessons/basic-gripper-usage/">Basic Gripper Usage</a><br>
<a href="http://arcbotics.com/lessons/follow-light/">Follow and Avoid Light</a><br>
<a title="Edge Avoidance" href="http://arcbotics.com/lessons/edge-avoidance/">Edge Avoidance</a><br>
<a title="Theremin" href="http://arcbotics.com/lessons/theremin/">Theremin</a><br>
<a title="Hill Climb" href="http://arcbotics.com/lessons/hill-climb/">Hill Climb</a><br>
<a title="Line Following" href="http://arcbotics.com/lessons/line-following/">Line Following</a><br>
<a href="http://arcbotics.com/lessons/cleaning-robot/">Cleaning Robot</a><br>
<a href="http://arcbotics.com/lessons/drawing-with-sparki/">Drawing with Sparki</a><br>
<a href="http://arcbotics.com/lessons/making-music-with-the-accelerometer/">Making Music with the Accelerometer</a><br>
<a href="http://arcbotics.com/lessons/using-usb-serial-and-bluetooth-communications/">Using USB Serial and Bluetooth Communications</a></p>
<h5><a href="http://arcbotics.com/lessons/advanced-sparkiduino-lessons/">Advanced SparkiDuino Lessons</a></h5>
<p><a href="./Maze Solving_files/Maze Solving.htm">Maze Solving</a><br>
<a href="http://arcbotics.com/lessons/object-retrieval/">Object Retrieval</a><br>
<a href="http://arcbotics.com/lessons/signal-filtering-techniques/">Signal Filtering Techniques</a><br>
<a href="http://arcbotics.com/lessons/room-navigation/">Room Navigation</a><br>
<a href="http://arcbotics.com/lessons/computer-inputs/">Computer Inputs</a><br>
<a href="http://arcbotics.com/lessons/relay-race/">Relay Race</a></p>
<h5><a href="http://arcbotics.com/basic-sparki-android-lessons/">Basic Sparki + Android™ Lessons</a></h5>
<p><a href="http://arcbotics.com/lessons/sparki-android/">Sparki + Android™: Introduction</a><br>
<a href="http://arcbotics.com/lessons/sparki-android-multiple-sensors/">Sparki + Android™: Multiple Sensors</a></p>
<h5><a href="http://arcbotics.com/lessons/basic-minibloq-lessons/">Basic miniBloq Lessons</a></h5>
<p><a href="http://arcbotics.com/lessons/minibloq-moving-the-robot/">Moving the Robot</a><br>
<a href="http://arcbotics.com/lessons/mixing-colors-with-the-rgb-led-minibloq/">Mixing Colors with the RGB LED</a><br>
<a href="http://arcbotics.com/lessons/making-sounds-minibloq/">Making Sounds</a><br>
<a href="http://arcbotics.com/lessons/using-the-ultrasonic-distance-sensor-minibloq/">Using the Ultrasonic Distance Sensor</a><br>
<a href="http://arcbotics.com/lessons/wall-avoidance-minibloq/">Wall Avoidance</a><br>
<a href="http://arcbotics.com/lessons/basic-gripper-usage-minibloq/">Basic Gripper Usage</a><br>
<a href="http://arcbotics.com/lessons/follow-and-avoid-light-minibloq/">Follow and Avoid Light</a><br>
<a href="http://arcbotics.com/lessons/edge-avoidance-minibloq/">Edge Avoidance</a><br>
<a href="http://arcbotics.com/lessons/hill-climb-minibloq/">Hill Climb</a><br>
<a href="http://arcbotics.com/lessons/line-following-minibloq/">Line Following</a><br>
<a href="http://arcbotics.com/lessons/cleaning-robot-minibloq/">Cleaning Robot</a><br>
<a href="http://arcbotics.com/lessons/making-music-with-the-accelerometer-minibloq/">Making Music with the Accelerometer</a><a href="http://arcbotics.com/lessons/using-usb-serial-and-bluetooth-communications-minibloq/"><br>
</a></p>
<hr>
<h3><a id="IntroductionToProgramming"></a><span style="color: #808080;"><strong></strong><strong>Introduction to Programming</strong></span></h3>
<hr>
<h5><a title="Basic Sparki Code" href="http://arcbotics.com/lessons/basic-code/">Basic Sparki Code</a></h5>
<h5><a title="Variables" href="http://arcbotics.com/lessons/variables/">Variables</a></h5>
<p><a title="Integer Numbers" href="http://arcbotics.com/lessons/variables/integer-numbers/">Integer Numbers</a><br>
<a title="Floating Point Numbers" href="http://arcbotics.com/lessons/variables/floating-point-numbers/">Floating Point Numbers</a><br>
<a title="Characters" href="http://arcbotics.com/lessons/variables/characters/">Characters</a><br>
<a title="Arrays" href="http://arcbotics.com/lessons/variables/arrays/">Arrays</a></p>
<h5><a title="Functions" href="http://arcbotics.com/lessons/functions/">Functions</a></h5>
<h5><a title="Controls" href="http://arcbotics.com/lessons/controls/">Controls</a></h5>
<p><a href="http://arcbotics.com/lessons/controls/if-statements/">If Statements</a><br>
<a href="http://arcbotics.com/lessons/controls/switch-statements/">Switch Statements</a><br>
<a href="http://arcbotics.com/lessons/controls/while-statements/">While Statements</a><br>
<a href="http://arcbotics.com/lessons/controls/for-statements/">For Statements</a></p>
<h5><a title="Beyond Basic Coding" href="http://arcbotics.com/lessons/beyond-basic-coding/">Beyond Basic Coding</a></h5>
<hr>
<h3><a id="Parts"></a><span style="color: #808080;"><strong></strong><strong>Parts</strong></span></h3>
<hr>
<h5><a href="http://arcbotics.com/products/sparki/parts/">All Sparki Parts</a></h5>
<p><a title="Accelerometer" href="http://arcbotics.com/products/sparki/parts/accelerometer/">Accelerometer</a><br>
<a title="Bluetooth Module" href="http://arcbotics.com/parts/bluetooth-module/">Bluetooth Module</a><br>
<a title="Buzzer" href="http://arcbotics.com/products/sparki/parts/buzzer/">Buzzer</a><br>
<a title="Expansion Port" href="http://arcbotics.com/products/sparki/parts/expansion-port/">Expansion Port</a><br>
<a title="Gripper" href="http://arcbotics.com/products/sparki/parts/gripper/">Gripper</a><br>
<a title="Infrared LED" href="http://arcbotics.com/products/sparki/parts/infrared-led/">Infrared LED</a><br>
<a title="Infrared Reflectance Sensor" href="http://arcbotics.com/products/sparki/parts/infrared-reflectance-sensor/">Infrared Reflectance Sensor</a><br>
<a title="Infrared Remote" href="http://arcbotics.com/products/sparki/parts/infrared-remote/">Infrared Remote</a><br>
<a title="Infrared Remote Receiver" href="http://arcbotics.com/infrared-remote-receiver/">Infrared Remote Receiver</a><br>
<a title="LCD" href="http://arcbotics.com/products/sparki/parts/lcd/">LCD</a><br>
<a title="Light Sensor" href="http://arcbotics.com/light-sensor/">Light Sensor</a><br>
<a title="Magnetometer" href="http://arcbotics.com/products/sparki/parts/magnetometer/">Magnetometer</a><br>
<a title="Marker Holder" href="http://arcbotics.com/products/sparki/parts/marker-holder/">Marker Holder</a><br>
<a title="On/Off Switch" href="http://arcbotics.com/products/sparki/parts/onoff-switch/">On/Off Switch</a><br>
<a title="Reset Button" href="http://arcbotics.com/products/sparki/parts/reset-button/">Reset Button</a><br>
<a title="RGB LED" href="http://arcbotics.com/products/sparki/parts/rgb-led/">RGB LED</a><br>
<a title="Status LED" href="http://arcbotics.com/products/sparki/parts/status-led/">Status LED</a><br>
<a title="Wheels" href="http://arcbotics.com/products/sparki/parts/wheels/">Wheels</a><br>
<a title="Servo" href="http://arcbotics.com/products/sparki/parts/servo/">Servo</a><br>
<a title="Stepper Motor" href="http://arcbotics.com/products/sparki/parts/stepper-motor/">Stepper Motors</a><br>
<a title="Ultrasonic Range Finder" href="http://arcbotics.com/products/sparki/parts/ultrasonic-range-finder/">Ultrasonic Range Finder</a></p>
<div id="crayon-52f68eea6d6f9785055515" data-settings=" minimize scroll-mouseover">
<hr>
</div>
<p><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://creativecommons.org&#39;]);" rel="license"><img style="border-width: 0;" alt="Creative Commons License" src="./Maze Solving_files/88x31.png"></a><br>
This work is licensed under a <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;outbound-article&#39;,&#39;http://creativecommons.org&#39;]);" rel="license">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>
</div></div>
</div>
 
</div>
 
</div>
 
</div>
</div>
</div>
</div>
<div id="wrapper_bottom"></div>
 
<div id="footer">
<div class="footer_con">
 
<div class="part1">
</div>
 
<div class="part2">
</div>
</div>
</div>
 
 


 <iframe style="display: none;"></iframe><iframe style="display: none;"></iframe><script id="twitter-csp-test"></script><a href="javascript:void(0);" title="SumoMe" style="background-color: rgb(15, 82, 186); position: fixed; z-index: 10000000000; padding: 0px; background-image: url(http://d2hpw6pw4uian4.cloudfront.net/static/cd9b6d0f6c87b2a6f2efeceecc134b87d6ccd66e/client/images/control-apps.png); width: 44px; height: 40px; text-indent: -10000px; display: block !important; bottom: 40px; left: -40px; background-position-x: 4px; background-repeat: no-repeat no-repeat;"></a><a href="javascript:void(0);" title="SumoMe" style="background-color: rgb(15, 82, 186); position: fixed; z-index: 10000000000; padding: 0px; background-image: url(http://d2hpw6pw4uian4.cloudfront.net/static/cd9b6d0f6c87b2a6f2efeceecc134b87d6ccd66e/client/images/control-apps.png); width: 44px; height: 40px; text-indent: -10000px; display: block !important; bottom: 40px; left: -40px; background-position-x: 4px; background-repeat: no-repeat no-repeat;"></a><img src="./Maze Solving_files/saved_resource" alt="" style="display: none;"></body></html>